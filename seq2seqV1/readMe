这是一个初级版本代码，有点乱，参照referenceCode里面实现的
